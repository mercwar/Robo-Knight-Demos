<!-- ============================================================
     AIFVS ARTIFACT HEADER
     ------------------------------------------------------------
     artifact_id: ART-0100-desktop-shell
     name: SYMSYS DHTML Desktop Shell
     role: VIEW
     version: 1.0.0
     tech: HTML + CSS + JS
     category: ANIMATED_UI
     datalake: js.dhtml.graphics/desktop
     generated_by: Copilot
     ============================================================ -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SYMSYS Desktop</title>

<style>
/* === GLOBAL BLACK-ON-BLACK THEME === */
html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    width: 100%;
    overflow: hidden;
    background: #000;
    font-family: system-ui, sans-serif;
    color: #e5e5e5;
}

/* === DESKTOP BACKGROUND === */
#desktop {
    position: relative;
    width: 100vw;
    height: 100vh;
    background:
        radial-gradient(circle at 20% 30%, rgba(250, 204, 21, 0.12), transparent 60%),
        radial-gradient(circle at 80% 70%, rgba(192, 192, 192, 0.10), transparent 60%),
        #000;
}

/* === WINDOW FRAME === */
.window {
    position: absolute;
    background: #050505;
    border: 1px solid #444; /* silver */
    border-radius: 6px;
    box-shadow: 0 0 18px rgba(250, 204, 21, 0.15); /* yellow glow */
    display: flex;
    flex-direction: column;
    color: #e5e5e5;
}

.window.active {
    border-color: #facc15;
    box-shadow: 0 0 28px rgba(250, 204, 21, 0.45);
}

/* === TITLE BAR === */
.window-titlebar {
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: linear-gradient(to right, #000, #111);
    border-bottom: 1px solid #facc15;
    padding: 0 10px;
    cursor: move;
    user-select: none;
}

.window-title {
    font-size: 13px;
    letter-spacing: 0.05em;
    color: #fefce8;
}

/* === WINDOW CONTROLS === */
.window-controls {
    display: flex;
    gap: 4px;
}

.window-controls button {
    width: 18px;
    height: 18px;
    border-radius: 3px;
    border: none;
    font-size: 11px;
    padding: 0;
    background: #111;
    color: #c0c0c0; /* silver */
    cursor: pointer;
}

.window-controls button:hover {
    background: #facc15;
    color: #000;
}

.window-controls .btn-close:hover {
    background: #b91c1c;
    color: #fee2e2;
}

/* === WINDOW CONTENT === */
.window-content {
    flex: 1;
    background: #020202;
    border-radius: 0 0 6px 6px;
    overflow: hidden;
}

.window-content iframe {
    width: 100%;
    height: 100%;
    border: none;
    background: #020202;
}

/* === AJAX LOADER === */
.loader {
    width: 32px;
    height: 32px;
    border: 4px solid #222;
    border-top-color: #facc15;
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    margin: 40px auto;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}
/* AVIS-PURE: DIRECTORY FRAME STYLE MATCH */
#directory-frame {
    width: 100%;
    height: calc(100vh - 160px); /* adjust for header/footer */
    border: 2px solid #c9a94a;   /* same gold as buttons */
    background: #111;            /* AVIS dark surface */
    box-shadow: 0 0 12px rgba(255, 215, 0, 0.35);
    border-radius: 6px;
}

</style>
</head>

<body>
<div id="desktop">

    <!-- FILE BROWSER WINDOW -->
    <div class="window" data-window-id="file-browser"
         style="left: 60px; top: 60px; width: 720px; height: 420px;">
        <div class="window-titlebar">
            <span class="window-title">Gemini Novel Browser</span>
            <div class="window-controls">
                <button class="btn-min">&#x2212;</button>
                <button class="btn-max">&#x2610;</button>
                <button class="btn-close">&#x2715;</button>
            </div>
        </div>
        <div class="window-content">
            <iframe src="CVBGOD.HTML"></iframe>
        </div>
    </div>

    <!-- SEARCH WINDOW -->
    <div class="window" data-window-id="search"
         style="left: 220px; top: 120px; width: 600px; height: 380px;">
        <div class="window-titlebar">
            <span class="window-title">Internet Search</span>
            <div class="window-controls">
                <button class="btn-min">&#x2212;</button>
                <button class="btn-max">&#x2610;</button>
                <button class="btn-close">&#x2715;</button>
            </div>
        </div>
        <div class="window-content" id="search-content"></div>
    </div>

    <!-- IMAGE VIEWER WINDOW -->
    <div class="window" data-window-id="image-viewer"
         style="left: 340px; top: 200px; width: 500px; height: 360px;">
        <div class="window-titlebar">
            <span class="window-title">Image Viewer</span>
            <div class="window-controls">
                <button class="btn-min">&#x2212;</button>
                <button class="btn-max">&#x2610;</button>
                <button class="btn-close">&#x2715;</button>
            </div>
        </div>
        <div class="window-content" id="image-viewer-content"></div>
    </div>

</div>

<script>
/* ============================================================
   SYMSYS WINDOW MANAGER â€” DRAG, FOCUS, MIN/MAX/CLOSE
   ============================================================ */

let zCounter = 10;
let dragState = null;

function bringToFront(win) {
    zCounter++;
    win.style.zIndex = zCounter;
    document.querySelectorAll(".window").forEach(w => w.classList.remove("active"));
    win.classList.add("active");
}

function onTitleMouseDown(e) {
    const win = e.currentTarget.closest(".window");
    bringToFront(win);

    const rect = win.getBoundingClientRect();
    dragState = {
        win,
        startX: e.clientX,
        startY: e.clientY,
        startLeft: rect.left,
        startTop: rect.top
    };

    document.addEventListener("mousemove", onMouseMove);
    document.addEventListener("mouseup", onMouseUp);
}

function onMouseMove(e) {
    if (!dragState) return;

    const dx = e.clientX - dragState.startX;
    const dy = e.clientY - dragState.startY;

    dragState.win.style.left = dragState.startLeft + dx + "px";
    dragState.win.style.top = dragState.startTop + dy + "px";
}

function onMouseUp() {
    dragState = null;
    document.removeEventListener("mousemove", onMouseMove);
    document.removeEventListener("mouseup", onMouseUp);
}

function attachWindow(win) {
    const title = win.querySelector(".window-titlebar");
    title.addEventListener("mousedown", onTitleMouseDown);

    win.addEventListener("mousedown", () => bringToFront(win));

    const content = win.querySelector(".window-content");
    const btnMin = win.querySelector(".btn-min");
    const btnMax = win.querySelector(".btn-max");
    const btnClose = win.querySelector(".btn-close");

    btnMin.onclick = e => {
        e.stopPropagation();
        content.style.display = content.style.display === "none" ? "block" : "none";
    };

    btnMax.onclick = e => {
        e.stopPropagation();
        const max = win.dataset.max === "true";
        if (!max) {
            win.dataset.old = JSON.stringify({
                left: win.style.left,
                top: win.style.top,
                width: win.style.width,
                height: win.style.height
            });
            win.style.left = "5vw";
            win.style.top = "5vh";
            win.style.width = "90vw";
            win.style.height = "85vh";
            win.dataset.max = "true";
        } else {
            const old = JSON.parse(win.dataset.old);
            win.style.left = old.left;
            win.style.top = old.top;
            win.style.width = old.width;
            win.style.height = old.height;
            win.dataset.max = "false";
        }
    };

    btnClose.onclick = e => {
        e.stopPropagation();
        win.style.display = "none";
    };
}

document.querySelectorAll(".window").forEach(attachWindow);

/* ============================================================
   AJAX SEARCH LOADER
   ============================================================ */

/* ============================================================
   AJAX SEARCH LOADER (FIXED FOR PUBLIC JSON URI)
   ============================================================ */
/* ============================================================
   AVIS SEARCH LOADER (CORS BYPASS FIX)
   ============================================================ */
function loadSearch(query) {
    const container = document.getElementById("search-content");
    container.innerHTML = `<div class="loader" style="color:#facc15">[AVIS] PENETRATING PUBLIC STREAM...</div>`;

    const callbackName = "avis_callback_" + Math.floor(Math.random() * 10000);

    window[callbackName] = function(data) {
        const suggestions = data[1];
        let html = `<h2 style='color:#facc15'>[AVIS] STREAM DATA: ${query}</h2><ul style="list-style:none; padding:0;">`;

        if (suggestions && suggestions.length > 0) {
            suggestions.forEach(text => {
                const link = "https://github.com/" + encodeURIComponent(text);
                html += `
                    <li style="margin-bottom:10px;">
                        <span style="color:#383838">>></span>
                        <a href="${link}" target="_blank" style="color:#c0c0c0; text-decoration:none; font-family: 'Courier New', monospace;">
                            ${text.toUpperCase()}
                        </a>
                    </li>`;
            });
        } else {
            html += `<li style="color:#facc15">STREAMS EMPTY: NO REPO DATA INDEXED.</li>`;
        }

        html += "</ul>";
        container.innerHTML = html;

        const s = document.getElementById(callbackName);
        if (s) s.remove();
        delete window[callbackName];
    };

    const script = document.createElement("script");
    script.id = callbackName;

    script.src =
        `https://suggestqueries.google.com/complete/search` +
        `?client=firefox` +
        `&q=${encodeURIComponent(query)}` +
        `&callback=${callbackName}`;

    document.body.appendChild(script);
}

loadSearch("github");




/* ============================================================
   IMAGE LOADER
   ============================================================ */

function loadImageAsync(url) {
    const container = document.getElementById("image-viewer-content");
    container.innerHTML = `<div class="loader"></div>`;

    const img = new Image();
    img.onload = () => {
        container.innerHTML = "";
        img.style.opacity = "0";
        img.style.transition = "opacity 0.6s ease";
        container.appendChild(img);
        requestAnimationFrame(() => img.style.opacity = "1");
    };
    img.onerror = () => {
        container.innerHTML = "<p style='color:#facc15'>Image failed to load.</p>";
    };
    img.src = url;
}

loadImageAsync("https://raw.githubusercontent.com/mercwar/Cyborg/refs/heads/main/images/image_2026-01-27_161530691.png");
</script>

</body>
</html>
